<!DOCTYPE html>
<html>
  <head>
    
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K4NG57N');</script>
<!-- End Google Tag Manager -->
    
    <title>Hello World</title>
  </head>
  <body>
<script>
  // Function to extract key-value pairs from the URL and push to the data layer
  function extractKeyValueFromURL() {
    // Get the URL query string
    var queryString = window.location.search.substring(1);

    // Split the query string into individual key-value pairs
    var keyValuePairs = queryString.split('&');

    // Iterate through the key-value pairs
    keyValuePairs.forEach(function(keyValuePair) {
      // Split each key-value pair into key and value
      var keyValue = keyValuePair.split('=');
      var key = decodeURIComponent(keyValue[0]); // Decode the key
      var value = decodeURIComponent(keyValue[1]); // Decode the value

      // Push the key-value pair to the data layer
      dataLayer.push({
        'key': key,
        'value': value
      });
    });
  }

  // Call the function to extract key-value pairs from the URL
  extractKeyValueFromURL();
</script>
    
    <script>
  // Function to make the API request
  function makeApiRequest() {
    // Get the key-value pairs from the GTM data layer
    var key = dataLayer[0].key; // Replace 'key' with your actual GTM variable name for the key
    var value = dataLayer[0].value; // Replace 'value' with your actual GTM variable name for the value
    console.log("Key:", key);
console.log("Value:", value);

    // Construct the API URL with the query string parameters
    var apiUrl = 'https://httpbin.org/get?key=' + key + '&value=' + value;

    // Make the GET request
    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        // Log the response in the console
        console.log(data);
      })
      .catch(error => {
        console.log('Error:', error);
      });
  }
    </script>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K4NG57N"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    
    <h1>Hello World</h1>
        <button onclick="makeApiRequest()">Make API Request</button>
  </body>
</html>
